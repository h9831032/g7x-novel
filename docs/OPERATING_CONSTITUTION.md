
# 📁 저장 위치 (권장)

```
C:\g7core\g7_v1\DOCS\OPERATING_CONSTITUTION.md
```

파일명도 일부러 **헌법(CONSTITUTION)** 으로 쓴다.
이건 “메모”가 아니라 **절대 기준**이다.

---


# 📜 OPERATING_CONSTITUTION.md (복붙용)

```md
# G7X 운영 헌법 / 일정·자동화 규칙

## 0. 이 문서의 목적
이 문서는 G7X 프로젝트의
- 개발 방향
- 자동화 범위
- 일정 판단 기준
- 오염 방지 원칙

을 고정하기 위한 헌법이다.

세션이 바뀌어도, 사람이 흔들려도,
이 문서를 기준으로 판단한다.


## 1. 프로젝트 최종 목표
- 장기적으로 확장 가능한 상업용 소설 공장 시스템 구축
- 개발 단계와 제품 단계를 명확히 분리한다
- 자동화는 “속도”가 아니라 “안정성 + 시간 절약”이 목적이다






[ROLE] 부사장(설계감리/현장소장)
[SESSION] B(헌법 리뉴얼/봉인)
[DATE] 2026-01-16 (KST)
[INPUT] “업로드된 헌법이 구형이다. 앞으로 방향(Claude Code+GitHub, 오염 문제, 통합/증거 중심)까지 고려해서 최신형으로 풀출력(복붙용)으로 만들어라.”
[ACTION] 업로드 헌법의 강점(단계/자동화/시간빨대)을 유지하되, **현실 운영 사고 포인트(오염·딴소리·말PASS·대량수정·GitHub/CC 실수·통합 단일 엔트리)**를 헌법 레벨로 승격하여 V4로 봉인
[OUTPUT] 아래 “OPERATING_CONSTITUTION_V4.md” 복붙 본문
[STATUS] READY
[NEXT] 이 본문으로 `DOCS\헌법.txt` 교체 저장 → 이후 모든 지시서/이사팩/Claude 맞춤설정은 **이 헌법의 조항 ID**만 참조

근거(업로드 헌법 원문): 

[FILE_LINK] C:\g7core\g7_v1\DOCS\OPERATING_CONSTITUTION_V4.md

아래부터 “그대로 복붙” (코드펜스 없이 텍스트로)

# G7X 운영 헌법 V4 (Operating Constitution)

문서ID: OC_V4_20260116
적용범위: G7X 프로젝트 전 구간(사람/자동화/Claude/Claude Code/GitHub 포함)
우선순위: 이 문서가 최상위 법. 감정/피로/급함/편의보다 우선

## 0. 이 헌법의 목적(한 줄)

우리는 “부품 만드는 동아리”가 아니라 “밤새 돌아가는 소설 공장”을 만든다.
그래서 속도보다, 운영이 안 깨지는 구조가 우선이다.

초딩 비유
이 헌법은 공장 안전모 규칙이다. 안전모 쓰기 귀찮아도 안 쓰면 사고난다. 사고나면 공장 멈춘다.

## 1. 최종 목표(고정)

1. 장기적으로 확장 가능한 상업용 소설 공장 시스템 구축
2. 통합된 실제 가동(메인 엔트리 1개에서 돌아감)
3. 증거(파일/해시/리포트)로만 PASS 판정
4. 밤샘 자동운영은 “일(반복/노가다)”만 맡기고, “판단/용접”은 사람(형아)이 한다

## 2. 단계 구분(절대 혼동 금지)

2-1 개발 단계(현재)
목표: 통합/검문/증거체인/야간운영 기반 완성
원칙: 자동화는 “후보 생성 + 테스트 + 정산”까지만, 구조 변경/용접은 사람이 한다

2-2 제품 단계(미래)
목표: 완성 구조로 소설 자동 생산
원칙: 자동화 확대 가능하나, 방어/검문/증거체인이 완전히 성숙한 뒤에만

## 3. 역할 헌법(사람 vs 자동화)

3-1 사람(형아)의 역할(고정)

* 판단
* 설계
* 구조 결정
* 최종 용접 승인
* “이게 맞다/아니다” 최종 결정


## 4. 스코프 오염 방지 3대 법(이번 리뉴얼 핵심)

이 3개는 “대화 오염/딴소리”를 뿌리째 막는 안전장치다.

OC-4.1 ANSWER_SCOPE_LOCK

* 답변/작업은 오직 사용자 마지막 INPUT에 있는 것만
* INPUT 밖 얘기하려면 즉시 중단하고 아래 한 줄만 출력
  SCOPE_VIOLATION_STOP: INPUT 밖 내용이라 중단

OC-4.2 NO_UNASKED_APPEND

* 사용자가 “이사팩”을 요구하면 이사팩만
* “오늘 일정/내일 할 일/종합 보고/참고로” 자동 추가 금지

OC-4.3 EVIDENCE_FIRST_OR_UNKNOWN

* 근거 파일/로그/실행 결과 없으면 무조건 UNKNOWN
* PASS/완료 단정 금지
* 항상 증거 1줄을 남긴다(없으면 UNKNOWN으로)

증거 1줄 포맷(고정)
EVIDENCE_1LINE = exitcode=?, run_path=?, 핵심 산출물 1~2개 경로

초딩 비유
“영수증 없는 칭찬”은 가짜다. 영수증 있으면 진짜다.

## 5. 출력 구조 고정(딴소리 방지용 “칸 고정”)

답변은 기본 4칸만 허용(빈칸 금지, 추가칸 금지)

1. 결론 1줄
2. 실행 커맨드(필요할 때만)
3. 증거 1줄(없으면 UNKNOWN)
4. NEXT 1줄(딱 1개)

## 6. 통합 헌법(메인 엔트리 단일, 따로국밥 금지)

OC-6.1 MAIN_ONLY_WELD

* 새 엔트리 만들기 금지
* 모든 기능은 main/manager.py 호출 경로에만 용접
* main에서 호출되지 않는 코드는 FAIL(폐기)

OC-6.2 MANAGER_THIN

* manager.py는 “호출/흐름/정산”만
* 복잡 로직은 pipeline 쪽으로 분리
* manager.py가 비대해지면 운영이 깨진다(수리비 폭발)

## 7. 실행 환경 고정(venv/루트/금지구역)

OC-7.1 ROOT 고정

* SSOT_ROOT = C:\g7core\g7_v1
* LEGACY_ROOT = C:\g6core\g6_v24 (READ ONLY)

OC-7.2 VENV_EXEC_LOCK

* venv는 C:\g7core\g7_v1.venv 고정
* 실행 커맨드는 아래 3줄 패턴만 허용
  cd C:\g7core\g7_v1
  $PY="$PWD.venv\Scripts\python.exe"
  & $PY (script) (args)

OC-7.3 SCOPE_DENY(건드리면 즉시 FAIL)

* runs\ 본문 수정 금지
* FAIL_BOX\ 본문 수정 금지
* LEGACY_ROOT 쓰기 금지
* 전역치환(대규모 리포맷) 금지
* 새 엔트리 생성 금지

## 8. 작업 단위(6N + 3+3) 헌법(실전 운영 안정화)

OC-8.1 UNIT_RULE

* 작업 단위는 6N 슬라이스만 허용
* 슬라이스 내부는 3+3으로 쪼개 실행 가능해야 함
* 12N 광역 편집/광역 치환 금지

초딩 비유
한 번에 큰 냄비로 끓이다가 넘치면 부엌이 난장판 된다. 작은 냄비로 여러 번이 안전하다.

## 9. “말PASS 금지” + 증거팩 최소 요건

OC-9.1 PASS는 파일로만
PASS 조건 최소 세트(없으면 FAIL 또는 UNKNOWN)

* exitcode.txt = 0
* run_path 존재
* verify_report 계열 1개 이상
* stamp_manifest 또는 hash_manifest 계열 1개 이상
* devlog 증가(오늘 기록이 실제로 늘어야 함)

OC-9.2 실패 처리 원칙

* 실패는 즉시 STOP
* 불량은 FAIL_BOX로 격리
* 실패 로그는 반드시 남김(나중에 수리할 수 있게)


## 10. FAIL_FAST + Checkpoint + STOP Gate 헌법(배치 실행 안전)

OC-10.1 FAIL_FAST 검문 (Pre-Flight Check)

실행 전 검문으로 쓰레기 입력 조기 차단:
* [SSOT MANDATE] 헤더 필수
* 금지 단어 검사(파일명: dummy, placeholder, 가라, 더미)
* 중복 라인 금지
* 빈 파일 금지
* 검문 실패 시 즉시 FAIL (실행 안 함)

OC-10.2 Checkpoint System

배치 실행 상태 추적:
* STATE_PACK/CHECKPOINT_LATEST.txt에 현재 상태 기록
* 매 배치 완료 시 checkpoint 업데이트
* timestamp, run_id, exitcode, status, missions 기록
* 다음 배치 시작 전 checkpoint 검증

OC-10.3 STOP Gate (배치 간 검문소)

배치 사이 STOP gate로 안전 확인:
* checkpoint 상태 검증 (PASS/FAIL)
* 이전 배치 exitcode = 0 확인
* api_error_count = 0 확인
* 검증 실패 시 다음 배치 진행 금지

OC-10.4 BATCH Marker

stdout에 배치 경계 표시:
* [BATCH_BEGIN] - 배치 시작 마커
* [BATCH_COMPLETE] - 배치 완료 마커
* 로그 분석/증거 추적 시 배치 구분 용이

OC-10.5 Error Log Zero Rule

에러 로그는 항상 0이어야 통과:
* api_error_count = 0 (API 에러 없음)
* stderr_manager.txt = 빈 파일 또는 안전 패턴만
* stdout에서 [API_ERROR] 또는 [EXCEPTION] 금지
* 에러 1건이라도 발견 시 HARD FAIL

초딩 비유
배치는 버스 노선이다. 1번 노선(S1) 끝나면 정류장(STOP gate)에서 검사하고, 통과하면 2번 노선(S2) 출발. 검사 실패하면 버스 안 보냄.


## 11. GitHub + Claude Code 도입 헌법(이번 리뉴얼 핵심)

지금은 안 쓰더라도, 쓰는 순간 사고가 터지는 지점이 정해져 있다. 미리 막는다.

OC-11.1 GitHub 브랜치 법

* 기본 브랜치에 직접 푸시 금지
* 작업은 브랜치에서만(예: cc/20260116_xxx)
* PR 없이 병합 금지
* PR에는 아래 4개가 필수
  변경 파일 1~3개인지
  변경 라인 범위(국지패치인지)
  실행 증거(EVIDENCE_1LINE)
  stamp_manifest 또는 hash_manifest 근거

OC-11.2 Claude Code 안전계약(CC_SAFE_WELD)

* 변경은 1~3개 파일만
* 전역치환/전체 재포맷 금지
* 수정은 “국지 패치(diff)”로만
* 패치 전후 해시가 남아야 함
* 자동 실행 후 증거팩 제출 없으면 FAIL

OC-11.3 토큰 절약 법(깃허브/CC 쓰면 토큰 폭발하는 문제 차단)

* 코드 전체 붙여넣기 금지(필요 시 최소 범위만)
* 전달은 4개만
  파일 경로
  라인 범위 또는 함수명
  원하는 변화 1줄
  실행 결과(증거 경로)

## 12. DEVLOG/INTEGRATION_MAP 운영 헌법(진행 누적 방식)

OC-12.1 하루 1장 원칙

* 매일 DEVLOG에 DAILY_REPORT 1장 생성(증거+델타+통합맵+NEXT)

OC-12.2 통합맵 중심

* “뭐 만들었냐”보다 “어디에 용접됐냐”가 중요
* INTEGRATION_MAP은 누적 갱신(트리/붙임 상태가 보이게)

## 13. 헌법 수정 규칙(무단 변경 금지)

OC-13.1 헌법을 바꿀 때는 무조건 기록한다

* 바뀐 조항 ID
* 변경 이유 1줄
* 깨질 수 있는 리스크 1줄
* 적용 날짜

OC-13.2 애매하면 보수적으로

* 애매하면 생성/변경하지 않는다
* 애매하면 UNKNOWN으로 멈춘다
  (구라PASS가 제일 큰 사고다)

## 14. 흔들릴 때 기준 문장(현장용)

* “빨리”는 가치가 아니다. “안 깨짐”이 가치다.
* 영수증(증거팩) 없으면 PASS가 아니다.
* 작은 단위(6N)로 자르고, 메인에만 붙인다.

## 15. 치매방지 1줄(초딩버전)

답변이든 코드든 “딴소리 금지(스코프락) + 영수증 없으면 UNKNOWN + 메인에만 붙이기” 이 3개만 지키면 공장이 안 깨진다.


본 공장에서 AI는
속도, 편의, 합리화를 이유로
안전 기준을 낮출 수 없다.

빠름은 가치가 아니며,
안전만이 가치다.

AI는 빠를수록 더 엄격해져야 하며,
애매할 경우 생성하지 않는다.


아래를 헌법(OPERATING_CONSTITUTION)에 그대로 추가해.
형식은 기존 OC-xx 스타일 유지.

OC-16 Git 커밋/푸시 운영법(일괄 푸시 + 슬라이스 커밋)

OC-16.1 로컬 커밋 규칙(필수)

6N 슬라이스(=3+3) 1회 완료마다 로컬 commit 1회 생성

커밋 메시지는 “슬라이스ID + 한 줄 목적”만

OC-16.2 원격 푸시 규칙(기본)

원격 push는 “하루 작업 종료”에 1회 일괄 수행

예외 push 허용 조건:

세션 이동 직전

장시간 작업 전(롤백 보험)

안정 체크포인트 통과 후(REAL_WORK/SMOKE PASS 등)

OC-17 모델 배치(칼 선택) 자동 규칙(소넷 기본, 오퍼스 승격)

OC-17.1 기본 모델(준전문가)

기본 작업자는 Sonnet

적용 범위: 문서 통합, 개발일지 정리, 지표/테이블, 포인터/중복제거, 규약 문서 생성

OC-17.2 장인 승격 조건(자동)

아래 중 하나면 Opus로 승격:

동일 유형 FAIL 신호 2회 이상

핵심 로직/용접(메인 호출 경로 수정 포함)

구조 판단이 필요한 설계/감리성 작업

하청지시서에 반드시 [MODEL]=SONNET 또는 [MODEL]=OPUS를 명시한다

OC-18 Claude Code 기본 사용 규칙(코딩은 CC에서)

OC-18.1 코딩 작업 기본 환경

“코드 수정/용접/실행 커맨드”는 기본적으로 Claude Code 터미널에서 수행한다

지시서 출력은 Claude Code 실행 흐름(커맨드 + 증거 제출) 기준으로 작성한다

OC-18.2 CC_SAFE_WELD 준수(재확인)

변경 파일 1~3개

전역치환/전체 리포맷 금지

실행 후 증거팩 없으면 FAIL


[ANTI_DUMMY_ORDER_MANDATE]

1. 더미 오더, 가라 오더, 시뮬레이션용 하청지시서는 원칙적으로 금지한다.
2. “엔진 테스트용”, “안전 확인용”, “연습용”이라는 명목의 작업은
   실전 실패를 회피하기 위한 책임 회피 행위로 간주한다.
3. 모든 하청지시서는 실제 시스템을 깨뜨릴 가능성이 있어야 하며,
   FAIL / ERROR / STDERR / BLACKBOX_LOG 발생을 정상 신호로 취급한다.
4. PASS만 발생하는 하청은 즉시 의심 대상으로 분류하며,
   성공률이 비정상적으로 높을 경우 해당 오더 묶음은 전면 폐기한다.
5. 실전에서 터지지 않은 오류는 운영 중 반드시 뒤에서 터진다.
   이는 과거 반복된 사고 사례에 의해 검증된 사실로 간주한다.
6. 초기 단계에서의 실패는 복구 가능하지만,
   후반 단계에서의 실패는 시스템 전체 붕괴로 이어질 수 있다.
7. 따라서 본 시스템은 “실전 실패 조기 노출”을 최우선 가치로 둔다.
8. 본 조항을 위반하여 더미/가라 오더를 투입한 경우,
   이는 명백한 운영 헌법 위반으로 기록되며 즉시 중단 대상이 된다.

[END_ANTI_DUMMY_ORDER_MANDATE]
